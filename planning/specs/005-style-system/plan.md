# خطة التنفيذ: نظام الأنماط السيادي

## الملخص
إعادة هيكلة معمارية الأنماط في الواجهة الأمامية لتصحيح مشاكل "ازدواجية الحقيقة"، وتنفيذ محرك رموز OKLCH/HSL قوي، وتمكين السيادة البصرية القائمة على الفئات (Tiers).

## السياق التقني
- **إطار العمل**: React + Vite
- **الأنماط**: SCSS (Preprocessor) + TailwindCSS (Utility)
- **الوضع الحالي**: روابط متغيرات مكسورة بين SCSS و CSS؛ تعريفات جذر مكررة.

## هيكل المشروع
التعديلات محصورة في `apps/frontend/src/styles/`.

## المراحل

### المرحلة 1: التأسيس (الإصلاح والتوحيد)
**الهدف**: إصلاح سلسلة المتغيرات المكسورة وتثبيت `_tokens.scss` كمصدر وحيد للحقيقة.
1.  **إعادة هيكلة `_tokens.scss`**: تعريف لوحة الألوان باستخدام خرائط SASS الصحيحة.
2.  **إنشاء `engine/_generator.scss`**: كتابة SASS mixin يقوم بالتكرار عبر الرموز وإخراج متغيرات `:root` صالحة.
3.  **تحديث `main.scss`**: استخدام المولد لحقن الأنماط.
4.  **تتنظيف `index.css`**: إزالة تعريفات `:root` المتعارضة.

### المرحلة 2: الجسر (تكامل Tailwind)
**الهدف**: ضمان أن Tailwind يستهلك المتغيرات التي تم توليدها في المرحلة 1 *بالضبط*.
1.  **إعادة هيكلة `tailwind.config.ts`**: تحديث تكوين `colors` للإشارة إلى أسماء متغيرات CSS الجديدة بدقة.
2.  **تحديث `_variables.scss`**: ضمان أن متغيرات SASS القديمة (`$primary-500`) تشير إلى متغيرات CSS الصالحة (`var(--primary-500)`).

### المرحلة 3: سيادة الخطط (محرك الفئات)
**الهدف**: تنفيذ التمايز البصري بناءً على اشتراك المستخدم.
1.  **تعريف رموز الفئات**: إنشاء خرائط محددة لـ `free`, `pro`, `premium` في SCSS.
2.  **حاقن الفئات (Tier Injector)**: تحديث المولد لإخراج متغيرات في نطاق `body[data-tier="..."]`.
3.  **التحقق البصري**: إنشاء صفحة "StyleGuide" لتصور التبديل بين الفئات.

## خطة التحقق
### آلياً
- `npm run build` (Frontend) لضمان نجاح تجميع SCSS.
- فحص التراجع البصري (يدوي) على نماذج تسجيل الدخول/التسجيل لضمان استعادة الألوان.

### يدوياً
1.  فتح صفحة `/login`.
2.  فحص العنصر (Inspect Element) على الزر الأساسي.
3.  التحقق من أنه يستخدم متغير CSS (مثلاً `--color-primary`).
4.  التحقق من أن المتغير يعمل بشكل صحيح (لون صالح).
