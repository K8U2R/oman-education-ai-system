# ๐ ุฎุทุฉ ุนูู ุดุงููุฉ ูุชุญุณูู ูุธุงู ุงูุฑุณุงุฆู ูุตูุงุญูุงุชูุง

## ๐ฏ ุงููุฏู ุงูุนุงู
ุชุทุจูู ูุธุงู ุตูุงุญูุงุช ูุชูุฏู ููุฑุณุงุฆู ูุน ุฅุถุงูุฉ ูุธุงุฆู ุงูุชุนุฏูู ูุงููุณุฎ ูุงูุฅุจูุงุบ ูุฅุนุงุฏุฉ ุงูุชูููุฏ ููู ูู ุฑุณุงุฆู ุงููุณุชุฎุฏู ูุฑุณุงุฆู ุงููุธุงู (AI).

---

## 1. โ๏ธ ูุธุงู ุงูุตูุงุญูุงุช (Role-Based Permissions)

### ุฌุฏูู ุงูุตูุงุญูุงุช

| ุงูุตูุงุญูุฉ/ุงูููุฒุฉ | ุฑุณุงูุฉ ุงููุณุชุฎุฏู (User Message) | ุฑุณุงูุฉ ุงููุธุงู (AI/Assistant Message) |
|:----------------|:------------------------------|:-------------------------------------|
| **ูุณุฎ (Copy)** | โ ูุชุงุญ | โ ูุชุงุญ |
| **ุชุนุฏูู (Edit)** | โ ูุชุงุญ (ูุฅุนุงุฏุฉ ุงูุตูุงุบุฉ/ุงูุชุตุญูุญ) | โ ุบูุฑ ูุชุงุญ |
| **ุฅุนุงุฏุฉ ุฅุฑุณุงู (Regenerate)** | โ ุบูุฑ ูุชุงุญ | โ ูุชุงุญ (ููุญุตูู ุนูู ุฑุฏ ุฌุฏูุฏ ูู AI) |
| **ุฅุจูุงุบ (Report)** | โ ุบูุฑ ูุชุงุญ | โ ูุชุงุญ (ููุฅุจูุงุบ ุนู ูุญุชูู ุบูุฑ ููุงุณุจ) |
| **ุญุฐู (Delete)** | โ ูุชุงุญ | โ ูุชุงุญ (ูุน ุชุญุฐูุฑ) |
| **ูุฑุงุกุฉ ุจุตูุช ูุณููุน (TTS)** | โ ุบูุฑ ููุทูู ุนุงุฏุฉู | โ ูุชุงุญ (ููุฒุฉ ุฅุถุงููุฉ) |

---

## 2. ๐งฑ ููููุฉ ูุงุฆูุฉ ุงูุฅุฌุฑุงุกุงุช (Context Menu)

### ุฃ. ูุงุฆูุฉ ุฑุณุงูุฉ ุงููุณุชุฎุฏู (User Message Menu)

| ุงูุฅุฌุฑุงุก | ุงูุฃููููุฉ | ุงููุธููุฉ | ุงูุดุฑุญ ูููุทูุฑ |
|:--------|:---------|:--------|:--------------|
| **ุชุนุฏูู ุงูุฑุณุงูุฉ** | `Edit` / `Pencil` | `handleEdit` | ููุชุญ ุงูุฑุณุงูุฉ ูู ูุถุน ุงูุชุนุฏูู (Edit Mode) ููุณูุญ ุจุฅุนุงุฏุฉ ุฅุฑุณุงููุง |
| **ูุณุฎ ุงููุญุชูู** | `Copy` / `Clipboard` | `handleCopy` | ูุณุฎ ุงููุต ูุงููุงู ุฅูู ุญุงูุธุฉ ุงูุฌูุงุฒ |
| **ุญุฐู ุงูุฑุณุงูุฉ** | `Trash2` / `X` | `handleDelete` | ุญุฐู ุงูุฑุณุงูุฉ ุงูุญุงููุฉ ูู ุงููุญุงุฏุซุฉ (ูุน ุชุญุฐูุฑ) |

### ุจ. ูุงุฆูุฉ ุฑุณุงูุฉ ุงููุธุงู (AI/Assistant Message Menu)

| ุงูุฅุฌุฑุงุก | ุงูุฃููููุฉ | ุงููุธููุฉ | ุงูุดุฑุญ ูููุทูุฑ |
|:--------|:---------|:--------|:--------------|
| **ูุณุฎ ุงููุญุชูู** | `Copy` / `Clipboard` | `handleCopy` | ูุณุฎ ุงูุฑุฏ ูุงููุงู ุฅูู ุญุงูุธุฉ ุงูุฌูุงุฒ |
| **ุฅุนุงุฏุฉ ุชูููุฏ ุงูุฑุฏ** | `RotateCw` / `Refresh` | `handleRegenerate` | ุฅุฑุณุงู ููุณ ุฑุณุงูุฉ ุงููุณุชุฎุฏู ุงูุณุงุจูุฉ ูุฑุฉ ุฃุฎุฑู ููุญุตูู ุนูู ุฑุฏ ุฌุฏูุฏ ูู AI |
| **ุงูุฅุจูุงุบ ุนู ุงูุฑุณุงูุฉ** | `Flag` / `AlertTriangle` | `handleReport` | ูุชุญ ูููุฐุฌ ุฅุจูุงุบ ุจุณูุท ุนู ุงููุญุชูู |
| **ุงููุฑุงุกุฉ ุจุตูุช ูุณููุน** | `Volume2` | `handleTextToSpeech` | ุชุดุบูู ูุฑุงุกุฉ ุตูุชูุฉ ูุฑุณุงูุฉ ุงููุธุงู (ููุฒุฉ ุฅุถุงููุฉ) |
| **ุญุฐู ุงูุฑุณุงูุฉ** | `Trash2` / `X` | `handleDelete` | ุญุฐู ุงูุฑุณุงูุฉ ุงูุญุงููุฉ ูู ุงููุญุงุฏุซุฉ (ูุน ุชุญุฐูุฑ) |

---

## 3. ๐๏ธ ุงูุจููุฉ ุงููุนูุงุฑูุฉ ุงูููุชุฑุญุฉ

### 3.1 ุชุญุฏูุซ ุฃููุงุน ุงูุจูุงูุงุช (Types)

```typescript
// types/chat.types.ts
export interface Message {
  id: string;
  role: 'user' | 'assistant';
  content: string;
  timestamp: Date;
  editedAt?: Date; // ุชุงุฑูุฎ ุขุฎุฑ ุชุนุฏูู
  isEdited?: boolean; // ูู ุชู ุชุนุฏูู ุงูุฑุณุงูุฉ
  originalContent?: string; // ุงููุญุชูู ุงูุฃุตูู ูุจู ุงูุชุนุฏูู
}

export interface MessageAction {
  id: string;
  label: string;
  icon: React.ComponentType;
  onClick: () => void;
  disabled?: boolean;
  variant?: 'default' | 'danger' | 'warning';
}

export interface ReportData {
  messageId: string;
  reason: string;
  description?: string;
}
```

### 3.2 ุงูููููุงุช ุงูุฌุฏูุฏุฉ ุงููุทููุจุฉ

#### ุฃ. `MessageContextMenu.tsx`
- ูุงุฆูุฉ ููุจุซูุฉ (Dropdown Menu) ุชุธูุฑ ุนูุฏ ุงูููุฑ ุนูู ุฃููููุฉ ุงูุฅุฌุฑุงุกุงุช
- ุฏููุงููููุฉ ุญุณุจ ููุน ุงูุฑุณุงูุฉ (User/Assistant)
- ุฏุนู RTL

#### ุจ. `MessageEditMode.tsx`
- ูููู ูุนุฑุถ ุงูุฑุณุงูุฉ ูู ูุถุน ุงูุชุนุฏูู
- ูุญุชูู ุนูู textarea ูุงุจูุฉ ููุชุนุฏูู
- ุฃุฒุฑุงุฑ: ุญูุธุ ุฅูุบุงุก

#### ุฌ. `ReportModal.tsx`
- ูููุฐุฌ ุฅุจูุงุบ ุนู ุฑุณุงูุฉ AI
- ุฎูุงุฑุงุช: ูุญุชูู ุบูุฑ ููุงุณุจุ ุฎุงุฑุฌ ุงูุณูุงูุ ูุนูููุงุช ุฎุงุทุฆุฉุ ุฃุฎุฑู
- ุญูู ูุตู ูููุตู (ุงุฎุชูุงุฑู)

#### ุฏ. `TextToSpeechButton.tsx`
- ุฒุฑ ูุชุดุบูู/ุฅููุงู ุงููุฑุงุกุฉ ุงูุตูุชูุฉ
- ุงุณุชุฎุฏุงู Web Speech API

### 3.3 ุชุญุฏูุซ ุงูููููุงุช ุงูุญุงููุฉ

#### ุฃ. `MessageItem.tsx`
- ุฅุถุงูุฉ ุฃููููุฉ ุงูุฅุฌุฑุงุกุงุช (MoreVertical)
- ุฏูุฌ `MessageContextMenu`
- ุฏุนู ูุถุน ุงูุชุนุฏูู
- ุฅุถุงูุฉ ูุนุงูุฌุงุช ููุฅุฌุฑุงุกุงุช

#### ุจ. `useMessageHandlers.ts`
- ุฅุถุงูุฉ `handleEditMessage`
- ุฅุถุงูุฉ `handleRegenerateResponse`
- ุฅุถุงูุฉ `handleDeleteMessage`
- ุฅุถุงูุฉ `handleReportMessage`

#### ุฌ. `ai-service.ts`
- ุชุญุฏูุซ `sendMessage` ูุฏุนู ูุนุงูู `editMessageId` (ููุชุนุฏูู)
- ุฅุถุงูุฉ `regenerateResponse` (ูุฅุนุงุฏุฉ ุงูุชูููุฏ)

---

## 4. ๐ ุณูุฑ ุงูุนูู (Workflow)

### 4.1 ุชุนุฏูู ุฑุณุงูุฉ ุงููุณุชุฎุฏู

```
1. ุงููุณุชุฎุฏู ูููุฑ ุนูู "ุชุนุฏูู" ูู ูุงุฆูุฉ ุงูุฅุฌุฑุงุกุงุช
2. MessageItem ูุชุญูู ุฅูู ูุถุน ุงูุชุนุฏูู (MessageEditMode)
3. ุงููุณุชุฎุฏู ูุนุฏู ุงููุต
4. ุงููุณุชุฎุฏู ูููุฑ ุนูู "ุญูุธ" ุฃู "ุฅุนุงุฏุฉ ุฅุฑุณุงู"
5. ุชุญุฏูุซ ุงูุฑุณุงูุฉ ูู messages array
6. ุฅุฑุณุงู ุงูุฑุณุงูุฉ ุงููุนุฏูุฉ ุฅูู AI
7. ุญุฐู ุงูุฑุฏ ุงููุฏูู ูู AI (ุฅู ูุฌุฏ)
8. ุฅุนุงุฏุฉ ุชูููุฏ ุฑุฏ ุฌุฏูุฏ ูู AI ุจูุงุกู ุนูู ุงูุณูุงู ุงููุญุฏุซ
```

### 4.2 ุฅุนุงุฏุฉ ุชูููุฏ ุฑุฏ ุงููุธุงู

```
1. ุงููุณุชุฎุฏู ูููุฑ ุนูู "ุฅุนุงุฏุฉ ุชูููุฏ" ูู ูุงุฆูุฉ ุฅุฌุฑุงุกุงุช ุฑุณุงูุฉ AI
2. ุงูุนุซูุฑ ุนูู ุฑุณุงูุฉ ุงููุณุชุฎุฏู ุงูุณุงุจูุฉ
3. ุญุฐู ุฑุณุงูุฉ AI ุงูุญุงููุฉ
4. ุฅุฑุณุงู ุฑุณุงูุฉ ุงููุณุชุฎุฏู ูุฑุฉ ุฃุฎุฑู ุฅูู AI
5. ุนุฑุถ ุฑุฏ ุฌุฏูุฏ
```

### 4.3 ุงูุฅุจูุงุบ ุนู ุฑุณุงูุฉ

```
1. ุงููุณุชุฎุฏู ูููุฑ ุนูู "ุงูุฅุจูุงุบ" ูู ูุงุฆูุฉ ุฅุฌุฑุงุกุงุช ุฑุณุงูุฉ AI
2. ูุชุญ ReportModal
3. ุงููุณุชุฎุฏู ูุฎุชุงุฑ ุงูุณุจุจ ููุฏุฎู ุงููุตู (ุงุฎุชูุงุฑู)
4. ุฅุฑุณุงู ุงูุจูุงูุงุช ุฅูู Backend (ุฃู ุญูุธ ูุญูู)
5. ุฅุบูุงู ุงููููุฐุฌ ูุฅุธูุงุฑ ุฑุณุงูุฉ ูุฌุงุญ
```

---

## 5. ๐ ูุงุฆูุฉ ุงูููุงู ุงูุชูููุฐูุฉ

### ุงููุฑุญูุฉ 1: ุชุญุฏูุซ ุงูุฃููุงุน ูุงูุจููุฉ ุงูุฃุณุงุณูุฉ
- [ ] ุชุญุฏูุซ `Message` interface ูู `types/chat.types.ts`
- [ ] ุฅุถุงูุฉ `MessageAction` interface
- [ ] ุฅุถุงูุฉ `ReportData` interface

### ุงููุฑุญูุฉ 2: ุฅูุดุงุก ุงูููููุงุช ุงูุฌุฏูุฏุฉ
- [ ] ุฅูุดุงุก `MessageContextMenu.tsx`
- [ ] ุฅูุดุงุก `MessageEditMode.tsx`
- [ ] ุฅูุดุงุก `ReportModal.tsx`
- [ ] ุฅูุดุงุก `TextToSpeechButton.tsx`

### ุงููุฑุญูุฉ 3: ุชุญุฏูุซ ุงูููููุงุช ุงูุญุงููุฉ
- [ ] ุชุญุฏูุซ `MessageItem.tsx` ูุฏุนู ุงูุฅุฌุฑุงุกุงุช
- [ ] ุชุญุฏูุซ `useMessageHandlers.ts` ุจุฅุถุงูุฉ ุงููุนุงูุฌุงุช
- [ ] ุชุญุฏูุซ `ai-service.ts` ูุฏุนู ุงูุชุนุฏูู ูุฅุนุงุฏุฉ ุงูุชูููุฏ

### ุงููุฑุญูุฉ 4: ุงูุชูุงูู ูุงูุงุฎุชุจุงุฑ
- [ ] ุฑุจุท ุฌููุน ุงูููููุงุช ูุนุงู
- [ ] ุงุฎุชุจุงุฑ ุชุนุฏูู ุฑุณุงูุฉ ุงููุณุชุฎุฏู
- [ ] ุงุฎุชุจุงุฑ ุฅุนุงุฏุฉ ุชูููุฏ ุฑุฏ ุงููุธุงู
- [ ] ุงุฎุชุจุงุฑ ุงูุฅุจูุงุบ ุนู ุฑุณุงูุฉ
- [ ] ุงุฎุชุจุงุฑ ุงููุฑุงุกุฉ ุงูุตูุชูุฉ
- [ ] ุงุฎุชุจุงุฑ RTL ูุงูุชุตููู ุงููุชุฌุงูุจ

---

## 6. ๐จ ุงุนุชุจุงุฑุงุช ุงูุชุตููู

### 6.1 Context Menu
- ููุถุน: ุฃุณูู/ููู ุฃููููุฉ ุงูุฅุฌุฑุงุกุงุช
- ุชุตููู: ุฎูููุฉ ุดูุงูุฉ ูุน backdrop blur
- ุงูุชูุงูุงุช: fade-in/slide-in
- RTL: ุฏุนู ูุงูู ููุนุฑุจูุฉ

### 6.2 Edit Mode
- textarea: ููุณ ุชุตููู ChatInput
- ุฃุฒุฑุงุฑ: ุญูุธ (ุฃุฎุถุฑ)ุ ุฅูุบุงุก (ุฑูุงุฏู)
- ุชุญุฐูุฑ: ุนูุฏ ุงูุฅูุบุงุก ูุน ูุฌูุฏ ุชุบููุฑุงุช

### 6.3 Report Modal
- ุชุตููู: ุจุณูุท ููุงุถุญ
- ุฎูุงุฑุงุช: Radio buttons ุฃู Select
- ุญูู ูุตู: ุงุฎุชูุงุฑูุ multiline

---

## 7. ๐ ุงูุฃูุงู ูุงูุชุญูู

### 7.1 ุงูุชุญูู ูู ุงูุตูุงุญูุงุช
- ุงูุชุญูู ูู `role` ูุจู ุนุฑุถ ุงูุฅุฌุฑุงุกุงุช
- ููุน ุชุนุฏูู ุฑุณุงุฆู ุงููุธุงู
- ููุน ุฅุนุงุฏุฉ ุชูููุฏ ุฑุณุงุฆู ุงููุณุชุฎุฏู

### 7.2 ุงูุชุญูู ูู ุงูุจูุงูุงุช
- ุงูุชุญูู ูู ุตุญุฉ ุงููุต ูุจู ุงูุชุนุฏูู
- ุงูุชุญูู ูู ูุฌูุฏ ุฑุณุงูุฉ ุงููุณุชุฎุฏู ูุจู ุฅุนุงุฏุฉ ุงูุชูููุฏ
- ุงูุชุญูู ูู ุตุญุฉ ุจูุงูุงุช ุงูุฅุจูุงุบ

---

## 8. ๐ ุงูุชุชุจุน ูุงูุชุญูููุงุช

### 8.1 ุงูุฃุญุฏุงุซ ุงููุทููุจ ุชุชุจุนูุง
- ุนุฏุฏ ูุฑุงุช ุงูุชุนุฏูู
- ุนุฏุฏ ูุฑุงุช ุฅุนุงุฏุฉ ุงูุชูููุฏ
- ุนุฏุฏ ูุฑุงุช ุงูุฅุจูุงุบ
- ุงุณุชุฎุฏุงู ุงููุฑุงุกุฉ ุงูุตูุชูุฉ

---

## 9. ๐ ุงูุฃููููุงุช

### ุนุงููุฉ ุงูุฃููููุฉ
1. ูุธุงู ุงูุตูุงุญูุงุช ุงูุฃุณุงุณู
2. ูุงุฆูุฉ ุงูุฅุฌุฑุงุกุงุช (Context Menu)
3. ุชุนุฏูู ุฑุณุงูุฉ ุงููุณุชุฎุฏู
4. ุฅุนุงุฏุฉ ุชูููุฏ ุฑุฏ ุงููุธุงู

### ูุชูุณุทุฉ ุงูุฃููููุฉ
5. ุงูุฅุจูุงุบ ุนู ุฑุณุงูุฉ
6. ุญุฐู ุงูุฑุณุงุฆู

### ููุฎูุถุฉ ุงูุฃููููุฉ
7. ุงููุฑุงุกุฉ ุงูุตูุชูุฉ (TTS)

---

## 10. ๐ ููุงุญุธุงุช ุฅุถุงููุฉ

- ูุฌุจ ุงูุญูุงุธ ุนูู ุงูุชูุงูู ูุน ุงูููุฏ ุงูุญุงูู
- ูุฌุจ ุฏุนู RTL ุจุงููุงูู
- ูุฌุจ ุชุญุณูู ุงูุฃุฏุงุก (memoization ุนูุฏ ุงูุญุงุฌุฉ)
- ูุฌุจ ุฅุถุงูุฉ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุงูููุงุณุจุฉ
- ูุฌุจ ุฅุถุงูุฉ ุฑุณุงุฆู ูุฌุงุญ/ุฎุทุฃ ูุงุถุญุฉ ูููุณุชุฎุฏู

