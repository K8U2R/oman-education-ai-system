@use '@/presentation/components/shell/Header/styles/variables' as *;


.container {
    position: relative;
    display: inline-block;
    /* z-index managed by stacking context of header, but dropdown needs to be high */
}

.trigger {
    display: flex;
    align-items: center;
    gap: clamp(0.5rem, 1vw, 0.75rem);
    padding: clamp(0.25rem, 0.5vw, 0.375rem);
    background: transparent;
    border: 1px solid transparent;
    border-radius: 9999px;
    cursor: pointer;
    transition: all $transition-speed-fast ease;
    color: var(--foreground);

    &:hover,
    &[aria-expanded="true"] {
        background: var(--accent);
        border-color: var(--border);
    }
}

.avatar {
    border-radius: 50%;
    border: 2px solid var(--background);
    box-shadow: 0 0 0 1px var(--border);

    &-placeholder {
        width: 2.5rem; // 40px
        height: 2.5rem;
        border-radius: 50%;
        background: var(--primary);
        color: var(--primary-foreground);
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 0.875rem;
    }
}

.chevron {
    width: 1rem; // 16px
    height: 1rem;
    color: var(--muted-foreground);
    transition: transform $transition-speed-fast ease;

    &--open {
        transform: rotate(180deg);
    }
}

.dropdown {
    position: absolute;
    top: 100%;
    right: 0; // Align right for LTR (swapped for RTL via logical props if possible, or directional SCSS)
    margin-top: clamp(0.5rem, 1vw, 0.75rem);

    // Fluid Width Constraint
    width: max-content;
    min-width: 15rem; // 240px
    max-width: calc(100vw - 2rem); // Prevent overflow on mobile

    background: var(--popover);
    color: var(--popover-foreground);
    border: 1px solid var(--border);
    border-radius: 0.75rem; // 12px
    box-shadow: $dropdown-shadow;

    z-index: $dropdown-z-index;
    overflow: hidden;

    // Animation
    transform-origin: top right;
    animation: slideDown $transition-speed cubic-bezier(0.16, 1, 0.3, 1);

    // RTL Support
    [dir="rtl"] & {
        right: auto;
        left: 0;
        transform-origin: top left;
    }
}

.header {
    padding: 1rem;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    background: var(--muted);
    border-bottom: 1px solid var(--border);

    &-info {
        overflow: hidden;
    }

    &-name {
        font-weight: 600;
        font-size: 0.875rem;
        color: var(--foreground);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    &-email {
        font-size: 0.75rem; // 12px
        color: var(--muted-foreground);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
}

.groups {
    padding: 0.5rem;
    max-height: 60vh;
    overflow-y: auto;
}

.group-label {
    padding: 0.5rem 0.75rem;
    font-size: 0.75rem; // 12px
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--muted-foreground);
    font-weight: 600;
}

.item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    width: 100%;
    padding: 0.625rem 0.75rem;
    border: none;
    border-radius: 0.375rem; // 6px
    background: transparent;
    color: var(--foreground);
    font-size: 0.875rem;
    cursor: pointer;
    text-align: inherit;
    transition: background $transition-speed-fast;

    &:hover {
        background: var(--accent);
        color: var(--accent-foreground);
    }

    &-icon {
        width: 1.125rem; // 18px
        height: 1.125rem;
        color: var(--muted-foreground);
    }

    &--dangerous {
        color: var(--destructive);

        &:hover {
            background: var(--destructive);
            color: var(--destructive-foreground);

            .item-icon {
                color: currentColor;
            }
        }

        .item-icon {
            color: var(--destructive);
        }
    }
}

.divider {
    height: 1px;
    background: var(--border);
    margin: 0.25rem 0;
}

@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateY(-0.5rem) scale(0.98);
    }

    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}