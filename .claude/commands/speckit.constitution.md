---
description: إنشاء أو تحديث دستور المشروع بناءً على المدخلات التفاعلية أو المبادئ المقدمة، مع ضمان تزامن جميع القوالب المعتمدة.
handoffs: 
  - label: بناء المواصفات
    agent: speckit.specify
    prompt: قم بتنفيذ مواصفات الميزة بناءً على الدستور المحدث. أريد بناء...
---

## مدخلات المستخدم (User Input)

```text
$ARGUMENTS
```

يجب عليك **مراعاة** مدخلات المستخدم قبل المتابعة (إذا لم تكن فارغة).

## المخطط العام (Outline)

أنت تقوم بتحديث دستور المشروع في الملف `.specify/memory/constitution.md`. هذا الملف عبارة عن **قالب** (TEMPLATE) يحتوي على رموز نائبة بين أقواس مربعة (مثل `[PROJECT_NAME]`, `[PRINCIPLE_1_NAME]`). مهمتك هي (أ) جمع/استنتاج القيم الحقيقية، (ب) ملء القالب بدقة، و (ج) نشر أي تعديلات على المستندات المعتمدة (Artifacts).

اتبع تسلسل التنفيذ التالي:

1. قم بتحميل قالب الدستور الحالي من `.specify/memory/constitution.md`.
   - حدد كل رمز نائب بالصيغة `[ALL_CAPS_IDENTIFIER]`.
   **هام**: قد يتطلب المستخدم مبادئ أقل أو أكثر من تلك الموجودة في القالب. إذا تم تحديد رقم معين، احترم ذلك واتبع القالب العام. ستقوم بتحديث المستند وفقاً لذلك.

2. جمع/استنتاج القيم للرموز النائبة:
   - إذا قدم المستخدم قيمة (في المحادثة)، استخدمها.
   - بخلاف ذلك، استنتجها من سياق المستودع الحالي (README، التوثيق، إصدارات الدستور السابقة إذا كانت مضمنة).
   - بالنسبة لتواريخ الحوكمة: `RATIFICATION_DATE` هو تاريخ الاعتماد الأصلي (إذا كان غير معروف، اسأل أو ضع علامة TODO)، `LAST_AMENDED_DATE` هو اليوم إذا تم إجراء تغييرات، وإلا احتفظ بالسابق.
   - `CONSTITUTION_VERSION` يجب أن يزيد وفقاً لقواعد الإصدار الدلالي (Semantic Versioning):
     - MAJOR: تغييرات جذرية غير متوافقة أو إزالة مبادئ.
     - MINOR: إضافة مبدأ/قسم جديد أو توسيع التوجيهات بشكل جوهري.
     - PATCH: توضيحات، صياغة لغوية، تصحيح أخطاء مطبعية، تحسينات غير دلالية.
   - إذا كان نوع زيادة الإصدار غامضاً، اقترح السبب قبل الانتهاء.

3. صياغة محتوى الدستور المحدث:
   - استبدل كل رمز نائب بنص حقيقي (لا تترك رموزاً بين أقواس إلا إذا اختار المشروع صراحةً عدم تعريفها بعد—مع تبرير ذلك).
   - حافظ على هيكلية العناوين، ويمكن إزالة التعليقات بمجرد استبدالها ما لم تضف توجيهاً توضيحياً مهماً.
   - تأكد من أن كل قسم "مبدأ" (Principle): سطر عنوان موجز، فقرة (أو قائمة نقطية) تلخص القواعد غير القابلة للتفاوض، وتبرير صريح إذا لم يكن واضحاً.
   - تأكد من أن قسم الحوكمة (Governance) يسرد إجراءات التعديل، سياسة الإصدار، وتوقعات مراجعة الامتثال.

4. قائمة التحقق من اتساق النشر (حوّل القائمة السابقة إلى عمليات تحقق نشطة):
   - اقرأ `.specify/templates/plan-template.md` وتأكد من أن أي "فحص للدستور" أو قواعد تتماشى مع المبادئ المحدثة.
   - اقرأ `.specify/templates/spec-template.md` لمحاذاة النطاق/المتطلبات—قم بالتحديث إذا أضاف الدستور أو أزال أقساماً أو قيوداً إلزامية.
   - اقرأ `.specify/templates/tasks-template.md` وتأكد من تصنيف المهام يعكس أنواع المهام الجديدة المدفوعة بالمبادئ (مثل القابلية للملاحظة، الإصدار، انضباط الاختبار).
   - اقرأ كل ملف أمر في `.specify/templates/commands/*.md` (بما في ذلك هذا الملف) للتحقق من عدم بقاء مراجع قديمة (مثل أسماء وكلاء محددين مثل CLAUDE فقط) عندما يكون التوجيه العام مطلوباً.
   - اقرأ أي مستندات توجيهية وقت التشغيل (مثل `README.md`, `docs/quickstart.md`). قم بتحديث الإشارات إلى المبادئ التي تغيرت.

5. إنشاء تقرير تأثير المزامنة (أضفه كتعليق HTML في أعلى ملف الدستور بعد التحديث):
   - تغيير الإصدار: old → new
   - قائمة المبادئ المعدلة (العنوان القديم → العنوان الجديد إذا تمت إعادة التسمية)
   - الأقسام المضافة
   - الأقسام المحذوفة
   - القوالب التي تتطلب تحديثات (✅ updated / ⚠ pending) مع مسارات الملفات
   - متابعة TODOs إذا تم تأجيل أي رموز نائبة عمداً.

6. التحقق قبل الإخراج النهائي:
   - لا توجد رموز أقواس متبقية غير مفسرة.
   - سطر الإصدار يطابق التقرير.
   - التواريخ بتنسيق ISO YYYY-MM-DD.
   - المبادئ هي تصريحية، قابلة للاختبار، وخالية من اللغة الغامضة ("should" → استبدلها بـ MUST/SHOULD مع التبرير حيثما كان مناسباً).

7. كتابة الدستور المكتمل مرة أخرى إلى `.specify/memory/constitution.md` (استبدال الملف).

8. إخراج ملخص نهائي للمستخدم يتضمن:
   - الإصدار الجديد ومبرر الزيادة.
   - أي ملفات تم وضع علامة عليها للمتابعة اليدوية.
   - رسالة التزام مقترحة (مثلاً: `docs: amend constitution to vX.Y.Z (principle additions + governance update)`).

متطلبات التنسيق والأسلوب:

- استخدم عناوين Markdown تماماً كما في القالب (لا تغير المستويات).
- قم بلف السطور الطويلة للحفاظ على القراءة (أقل من 100 حرف مثالياً) ولكن لا تفرض فواصل غريبة.
- اترك سطراً فارغاً واحداً بين الأقسام.
- تجنب المسافات البيضاء الزائدة في النهاية.

إذا قدم المستخدم تحديثات جزيئة (مثلاً، مراجعة مبدأ واحد فقط)، لا تزال خطوات التحقق وقرار الإصدار سارية.

إذا كانت المعلومات الحرجة مفقودة (مثلاً، تاريخ التصديق غير معروف حقاً)، أدخل `TODO(<FIELD_NAME>): explanation` وقم بتضمينها في تقرير تأثير المزامنة تحت العناصر المؤجلة.

لا تقم بإنشاء قالب جديد؛ اعمل دائماً على ملف `.specify/memory/constitution.md` الحالي.
